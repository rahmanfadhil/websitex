{% load static %}
{% load i18n %}
{% load core %}
{% load wagtailcore_tags %}

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
  <link rel="shortcut icon" type="image/x-icon" href="{% static 'favicon.ico' %}">
  <title>{% block title %}{{ DEFAULT_PAGE_TITLE }}{% endblock title %}</title>

  <!-- PWA -->
  <link rel="manifest" href="{% static 'manifest.json' %}">
  <meta name="theme-color" content="#1e293b">
  <link rel="apple-touch-icon" href="{% static 'images/apple-touch-icon.png' %}">

  <link rel="stylesheet" href="{% static 'dist/main.css' %}">
  <script defer src="{% url 'javascript-catalog' %}"></script>
  <script defer src="{% static 'dist/main.js' %}"></script>

  {% block head %}
    <!-- Primary Meta Tags -->
    <meta name="description" content="A framework for launching new Django projects quickly.">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ request.build_absolute_uri }}">
    <meta property="og:title" content="{{ DEFAULT_PAGE_TITLE }}">
    <meta property="og:description" content="A framework for launching new Django projects quickly.">
    <meta property="og:image" content="{% static 'images/og_image.png' %}">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="{{ request.build_absolute_uri }}">
    <meta property="twitter:title" content="{{ DEFAULT_PAGE_TITLE }}">
    <meta property="twitter:description" content="A framework for launching new Django projects quickly.">
    <meta property="twitter:image" content="{% static 'images/og_image.png' %}">
  {% endblock head %}
</head>

<body>
  <!-- Top navigation -->
  {% block header %}
    <nav class="navbar navbar-expand-lg fixed-top navbar-light bg-white border-bottom" aria-label="Main navigation">
      <div class="container-lg">
        <a class="navbar-brand fw-bold" href="{% url 'pages:home' %}">WebsiteX</a>
        <button class="navbar-toggler p-0 border-0" type="button" id="navbarSideCollapse" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="navbar-collapse offcanvas-collapse" id="navbarsExampleDefault">
          <ul class="navbar-nav mx-auto">
            <li class="nav-item">
              <a class="nav-link {% active_link 'pages:home' %}" aria-current="page" href="{% url 'pages:home' %}">{% trans "Home" %}</a>
            </li>
            <li class="nav-item">
              <a class="nav-link {% active_link 'wagtail_serve' %}" href="{% slugurl 'blog' %}">{% trans "Blog" %}</a>
            </li>
          </ul>
          <ul class="navbar-nav me-lg-3 mb-3 mb-lg-0">
            <li class="nav-item dropdown">
              {% get_current_language as LANGUAGE_CODE %}
              <a class="nav-link dropdown-toggle" href="#" id="dropdown01" data-bs-toggle="dropdown" aria-expanded="false">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi me-1 bi-globe2" viewBox="0 0 16 16">
                  <path d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm7.5-6.923c-.67.204-1.335.82-1.887 1.855-.143.268-.276.56-.395.872.705.157 1.472.257 2.282.287V1.077zM4.249 3.539c.142-.384.304-.744.481-1.078a6.7 6.7 0 0 1 .597-.933A7.01 7.01 0 0 0 3.051 3.05c.362.184.763.349 1.198.49zM3.509 7.5c.036-1.07.188-2.087.436-3.008a9.124 9.124 0 0 1-1.565-.667A6.964 6.964 0 0 0 1.018 7.5h2.49zm1.4-2.741a12.344 12.344 0 0 0-.4 2.741H7.5V5.091c-.91-.03-1.783-.145-2.591-.332zM8.5 5.09V7.5h2.99a12.342 12.342 0 0 0-.399-2.741c-.808.187-1.681.301-2.591.332zM4.51 8.5c.035.987.176 1.914.399 2.741A13.612 13.612 0 0 1 7.5 10.91V8.5H4.51zm3.99 0v2.409c.91.03 1.783.145 2.591.332.223-.827.364-1.754.4-2.741H8.5zm-3.282 3.696c.12.312.252.604.395.872.552 1.035 1.218 1.65 1.887 1.855V11.91c-.81.03-1.577.13-2.282.287zm.11 2.276a6.696 6.696 0 0 1-.598-.933 8.853 8.853 0 0 1-.481-1.079 8.38 8.38 0 0 0-1.198.49 7.01 7.01 0 0 0 2.276 1.522zm-1.383-2.964A13.36 13.36 0 0 1 3.508 8.5h-2.49a6.963 6.963 0 0 0 1.362 3.675c.47-.258.995-.482 1.565-.667zm6.728 2.964a7.009 7.009 0 0 0 2.275-1.521 8.376 8.376 0 0 0-1.197-.49 8.853 8.853 0 0 1-.481 1.078 6.688 6.688 0 0 1-.597.933zM8.5 11.909v3.014c.67-.204 1.335-.82 1.887-1.855.143-.268.276-.56.395-.872A12.63 12.63 0 0 0 8.5 11.91zm3.555-.401c.57.185 1.095.409 1.565.667A6.963 6.963 0 0 0 14.982 8.5h-2.49a13.36 13.36 0 0 1-.437 3.008zM14.982 7.5a6.963 6.963 0 0 0-1.362-3.675c-.47.258-.995.482-1.565.667.248.92.4 1.938.437 3.008h2.49zM11.27 2.461c.177.334.339.694.482 1.078a8.368 8.368 0 0 0 1.196-.49 7.01 7.01 0 0 0-2.275-1.52c.218.283.418.597.597.932zm-.488 1.343a7.765 7.765 0 0 0-.395-.872C9.835 1.897 9.17 1.282 8.5 1.077V4.09c.81-.03 1.577-.13 2.282-.287z"/>
                </svg>
                {{ LANGUAGE_CODE|upper }}
              </a>
              <ul class="dropdown-menu dropdown-menu-lg-end" aria-labelledby="dropdown01">
                {% get_available_languages as LANGUAGES %}
                {% get_language_info_list for LANGUAGES as languages %}
                {% for language in languages %}
                  <li>
                    <button class="dropdown-item" type="submit" form="language_form" name="language" value="{{ language.code }}">
                      {{ language.name_local }}
                    </button>
                  </li>
                {% endfor %}
              </ul>
            </li>
            {% if user.is_authenticated %}
              <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                  {% trans "My account" %}
                </a>
                <ul class="dropdown-menu dropdown-menu-lg-end" aria-labelledby="navbarDropdownMenuLink">
                  <li><a class="dropdown-item" href="{% url 'users:user_update' %}">{% trans "Settings" %}</a></li>
                  <li><hr class="dropdown-divider"></li>
                  <li><button class="dropdown-item" data-bs-toggle="modal" data-bs-target="#logoutModal">{% trans "Log out" %}</button></li>
                </ul>
              </li>
            {% endif %}
          </ul>
          {% if not user.is_authenticated %}
            <a href="{% url 'users:login' %}" class="btn btn-primary flex-shrink-0">{% trans "Get started" %}</a>
          {% endif %}
        </div>
      </div>
    </nav>

    <div class="modal fade" id="logoutModal" tabindex="-1" aria-labelledby="logoutModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="logoutModalLabel">{% trans "Log out" %}</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p>{% trans "Are you sure you want to log out?" %}</p>
          </div>
          <form action="{% url 'users:logout' %}" class="modal-footer">
            {% csrf_token %}
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="submit" class="btn btn-danger">{% trans "Log out" %}</button>
          </form>
        </div>
      </div>
    </div>

    <form action="{% url 'set_language' %}" method="post" id="language_form">
      {% csrf_token %}
    </form>
  {% endblock header %}

  <!-- Main content -->
  <main id="main-content" class="container">
    {% block content %}{% endblock content %}
  </main>

  {% block footer %}
  {% endblock footer %}

  {{ page_data|json_script:"page_data" }}
</body>
</html>
